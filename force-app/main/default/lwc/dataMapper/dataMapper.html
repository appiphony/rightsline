<!-- Strike Data Mapper v2.1.0 -->
<template>
    <table class="slds-table slds-table_bordered slds-table_col-bordered slds-border_left slds-border_right">
        <thead class={header}>
            <tr class="slds-text-title_caps">
                <th style={headerStyle}>
                    <h4 class="slds-show_inline-block slds-var-m-left_small">{tpColumnName}</h4>
                </th>

                <th style={headerStyle}>
                    <h4 class="slds-show_inline-block slds-var-m-left_small">{sfColumnName}</h4>
                </th>
                <template if:true={showRemove}>
                    <th class="slds-text-align_center" style="width: 1px;">
                        <h4 class="slds-show_inline-block">Remove</h4>
                    </th>
                </template>
            </tr>
        </thead>
        <tbody>
            <!-- Table Empty State -->
            <template if:false={hasMappings}>
                <tr>
                    <td colspan={colSpan} class="slds-text-align_center">
                        <em class="slds-text-color_weak">No mappings have been added</em>
                    </td>
                </tr>
            </template>
            <!-- /Table Empty State -->

            <template if:true={mapping}>
                <template for:each={mapping.rows} for:item="row" for:index="rowIndex">
                    <tr key={row.id}>
                        <td>
                            <template if:true={row.tpOptions.length}>
                                <template if:false={hasStaticTp}>
                                    <c-picklist 
                                        name={mapping.name} 
                                        value={row.tpField}
                                        options={row.tpOptions} 
                                        searchable={mapping.searchable}
                                        readonly={row.tpReq}
                                        data-column="tp"
                                        data-rowindex={rowIndex}
                                        data-field-type={row.fieldType}
                                        onselect={updateRow}
                                        onclick={updateOptions}>
                                    </c-picklist>
                                </template>
                            </template>
                            <template if:false={row.tpOptions.length}>
                                <input
                                    class="slds-input"
                                    name={mapping.name} 
                                    value={row.tpField} 
                                    onblur={updateRow}
                                    data-column="tp"
                                    data-rowindex={rowIndex}
                                    data-field-type={row.fieldType}
                                    onclick={updateOptions}/>
                            </template>
                            <template if:true={hasStaticTp}>
                                <input
                                    class="slds-input"
                                    name={mapping.name} 
                                    value={row.tpField}
                                    data-column="tp"
                                    data-rowindex={rowIndex}
                                    data-field-type={row.fieldType}
                                    readonly
                                    disabled/>
                            </template>
                        </td>
                        <td>
                            <template if:true={row.sfOptions.length}>
                                <template if:false={hasStaticSf}>
                                    <c-picklist 
                                        name={mapping.name} 
                                        value={row.sfField}
                                        options={row.sfOptions} 
                                        searchable={mapping.searchable}
                                        readonly={row.sfReq}
                                        data-column="sf"
                                        data-rowindex={rowIndex}
                                        data-field-type={row.fieldType}
                                        onselect={updateRow}
                                        onclick={updateOptions}>
                                    </c-picklist>
                                </template>
                            </template>
                            <template if:false={row.sfOptions.length}>
                                <input
                                    class="slds-input"
                                    name={mapping.name}
                                    value={row.sfField}
                                    onblur={updateRow}
                                    data-column="sf"
                                    data-rowindex={rowIndex}
                                    data-field-type={row.fieldType}
                                    onclick={updateOptions}/>
                            </template>
                            <template if:true={hasStaticSf}>
                                <input
                                    class="slds-input"
                                    name={mapping.name}
                                    value={row.sfField}
                                    data-column="sf"
                                    data-rowindex={rowIndex}
                                    data-field-type={row.fieldType}
                                    readonly
                                    disabled/>
                            </template>
                        </td>

                        <template if:true={showRemove}>
                            <td class="slds-text-align_center" style="width: 1px;">
                                <span onclick={removeRow} data-rowindex={rowIndex}>
                                    <lightning-button-icon icon-name="utility:delete" alternative-text="remove" title="Remove"
                                        size="medium" variant="container" disabled={row.deletable}></lightning-button-icon>
                                </span>
                            </td>
                        </template>
                    </tr>
                </template>
            </template>
        </tbody>
    </table>
    <!-- Add Mapping Button -->
    <template if:true={addButton}>
        <div class="slds-var-p-top_small slds-grid slds-gutters">
            <div class="slds-col slds-grow-none">
                <lightning-button
                    label="Add Row"
                    title="Add Row"
                    onclick={addRow}>
                </lightning-button>
            </div>
        </div>
    </template>
    <!-- /Add Mapping Button -->
</template>
