<template>
    <c-step title="" header="Contact Field Mapping" container-size="large" next-label="Finish">
        <p slot="description">In order to determine how Salesforce represents Rightsline data in this org, you'll need to map fields from Rightsline contact templates to the Salesforce records of your choice. You can configure as many object and record type mappings as is necessary for your organization.</p> 
        <!-- Selected Object Mapping -->
                <div class="slds-border_top slds-border_bottom slds-border_left slds-border_right" style="border-radius:0.25rem;">
                    <div class="slds-grid">
                        <div class="rl-vertical_nav slds-col slds-border_right">
                            <lightning-vertical-navigation class="slds-var-m-bottom_small" selected-item="group" onselect={handleSectionSelect}>
                                <lightning-vertical-navigation-section label="Mappings">
                                    <lightning-vertical-navigation-item label={mappingName} name="group"></lightning-vertical-navigation-item>
                                </lightning-vertical-navigation-section>
                            </lightning-vertical-navigation>
                            <div class="slds-var-m-around_small">
                                <lightning-button
                                icon-name="utility:add"
                                label="New Mapping"
                                ></lightning-button>
                            </div>
                        </div>
                        <div class="rl-mapping_container slds-col slds-var-p-horizontal_large slds-var-p-bottom_large slds-p-top_small">
                            <template if:true={isGroup}>
                                <div class="slds-grid slds-border_bottom  slds-grid_vertical-align-end slds-var-m-bottom_large">
                                    <div class="slds-col slds-var-m-bottom_small slds-text-heading_small">Account - Customer Account</div>
                                    <div class="slds-col slds-var-m-bottom_small slds-grow-none">
                                        <lightning-button
                                            class="slds-button"
                                            variant="destructive-text"
                                            icon-name="utility:delete"
                                            onclick={openDeleteModal}
                                            label="Delete Mapping"
                                        ></lightning-button>
                                        <lightning-button
                                            class="slds-button"
                                            icon-name="utility:check"
                                            label="Save Mapping"
                                            onclick={saveMapping}
                                        ></lightning-button>
                                    </div>
                                </div>
                                <h2 class="slds-text-title_caps slds-var-m-bottom_x-small">Object Mapping</h2>
                                <div class="slds-grid slds-gutters slds-gutters_xx-small slds-var-m-bottom_x-small">
                                    <div class="slds-col slds-size_1-of-2">
                                        <c-picklist
                                            label="Rightsline Template"
                                            options={rlOptions}
                                            value={rlValue}
                                            onchange={updateRlValue}
                                        ></c-picklist>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2"></div>
                                </div>
                                <div class="slds-grid slds-gutters slds-gutters_xx-small slds-var-m-bottom_large">
                                    <div class="slds-col slds-size_1-of-2">
                                        <c-picklist
                                            label="Salesforce Object"
                                            options={objectOptions}
                                            value={objectValue}
                                            onchange={updateObjectValue}
                                        ></c-picklist>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <c-picklist
                                            label="Salesforce Record Type"
                                            value={recordTypeValue}
                                            options={recordTypeOptions}
                                            onchange={updateRecordValue}
                                        ></c-picklist>
                                    </div>
                                </div>
                                <h2 class="slds-text-title_caps slds-var-m-bottom_small">Field Mapping</h2>
                                <c-data-mapper
                                    show-remove="false"
                                    setup-data={setupData}
                                    sf-fields={sfFields}
                                    tp-fields={tpFields}
                                    sf-column-name="Salesforce"
                                    tp-column-name="Rightsline"
                                    sf-object={selectedObject}
                                    step="step1">
                                </c-data-mapper> 
                            </template>
                            <template if:true={isClient}>
                                <h2 class="slds-text-title_caps slds-m-bottom_small">Field Mapping</h2>
                                <c-data-mapper
                                    setup-data={setupData} 
                                    sf-fields={sfFields} 
                                    tp-fields={tpFields} 
                                    sf-column-name="Salesforce Field"
                                    tp-column-name="rl Client Field"
                                    sf-object={selectedObject}
                                    step="step1"
                                    has-no-unique>
                                </c-data-mapper> 
                            </template>
                            <div class="slds-grid slds-var-p-top_small slds-var-m-top_medium slds-border_top">
                                <div class="slds-col"></div>
                                <div class="slds-col slds-grow-none">
                                    <lightning-button
                                        class="slds-button"
                                        variant="destructive-text"
                                        icon-name="utility:delete"
                                        onclick={openDeleteModal}
                                        label="Delete Mapping"
                                    ></lightning-button>
                                    <lightning-button
                                        class="slds-button"
                                        icon-name="utility:check"
                                        onclick={saveMapping}
                                        label="Save Mapping"
                                    ></lightning-button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        <!-- Selected Event Mapping -->
    </c-step>
    <c-modal
        class="delete-modal"
        title="Delete Mapping"
        onsecondary={closeDeleteModal}>
        <div class="slds-text-align_center slds-is-relative">
            <p>Are you sure you want to delete the <strong>{objectLabelForDelete}</strong> mapping? This action can not be undone.</p>
        </div>
        <lightning-button
            slot="footer"
            variant="neutral"
            label="Cancel"
            onclick={closeDeleteModal}>
        </lightning-button>
        <lightning-button
            slot="footer"
            variant="destructive"
            label="Delete"
            onclick={deleteMapping}
            class="slds-var-m-left_x-small">
        </lightning-button>
    </c-modal>
</template>